async function moduleInitFunction(require,exports={}){function mkStex(mathMode){function pushCommand(state,command){state.cmdState.push(command)}function peekCommand(state){return 0<state.cmdState.length?state.cmdState[state.cmdState.length-1]:null}function popCommand(state){var plug=state.cmdState.pop();plug&&plug.closeBracket()}// returns the non-default plugin closest to the end of the list
function getMostPowerful(state){for(var plug,context=state.cmdState,i=context.length-1;0<=i;i--)if(plug=context[i],"DEFAULT"!=plug.name)return plug;return{styleIdentifier:function(){return null}}}function addPluginPattern(pluginName,cmdStyle,styles){return function(){this.name=pluginName,this.bracketNo=0,this.style=cmdStyle,this.styles=styles,this.argument=null,this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null},this.openBracket=function(){return this.bracketNo++,"bracket"},this.closeBracket=function(){}}}function setState(state,f){state.f=f}// called when in a normal (no environment) context
function normal(source,state){var plug;// Do we look like '\command' ?  If so, attempt to apply the plugin 'command'
if(source.match(/^\\[a-zA-Z@]+/)){var cmdName=source.current().slice(1);return plug=plugins.hasOwnProperty(cmdName)?plugins[cmdName]:plugins.DEFAULT,plug=new plug,pushCommand(state,plug),setState(state,beginParams),plug.style}// escape characters
if(source.match(/^\\[$&%#{}_]/))return"tag";// white space control characters
if(source.match(/^\\[,;!\/\\]/))return"tag";// find if we're starting various math modes
if(source.match("\\["))return setState(state,function(source,state){return inMathMode(source,state,"\\]")}),"keyword";if(source.match("\\("))return setState(state,function(source,state){return inMathMode(source,state,"\\)")}),"keyword";if(source.match("$$"))return setState(state,function(source,state){return inMathMode(source,state,"$$")}),"keyword";if(source.match("$"))return setState(state,function(source,state){return inMathMode(source,state,"$")}),"keyword";var ch=source.next();if("%"==ch)return source.skipToEnd(),"comment";if("}"==ch||"]"==ch){if(plug=peekCommand(state),plug)plug.closeBracket(ch),setState(state,beginParams);else return"error";return"bracket"}return"{"==ch||"["==ch?(plug=plugins.DEFAULT,plug=new plug,pushCommand(state,plug),"bracket"):/\d/.test(ch)?(source.eatWhile(/[\w.%]/),"atom"):(source.eatWhile(/[\w\-_]/),plug=getMostPowerful(state),"begin"==plug.name&&(plug.argument=source.current()),plug.styleIdentifier())}function inMathMode(source,state,endModeSeq){if(source.eatSpace())return null;if(endModeSeq&&source.match(endModeSeq))return setState(state,normal),"keyword";if(source.match(/^\\[a-zA-Z@]+/))return"tag";if(source.match(/^[a-zA-Z]+/))return"variableName.special";// escape characters
if(source.match(/^\\[$&%#{}_]/))return"tag";// white space control characters
if(source.match(/^\\[,;!\/]/))return"tag";// special math-mode characters
if(source.match(/^[\^_&]/))return"tag";// non-special characters
if(source.match(/^[+\-<>|=,\/@!*:;'"`~#?]/))return null;if(source.match(/^(\d+\.\d*|\d*\.\d+|\d+)/))return"number";var ch=source.next();return"{"==ch||"}"==ch||"["==ch||"]"==ch||"("==ch||")"==ch?"bracket":"%"==ch?(source.skipToEnd(),"comment"):"error"}function beginParams(source,state){var lastPlug,ch=source.peek();return"{"==ch||"["==ch?(lastPlug=peekCommand(state),lastPlug.openBracket(ch),source.eat(ch),setState(state,normal),"bracket"):/[ \t\r]/.test(ch)?(source.eat(ch),null):(setState(state,normal),popCommand(state),normal(source,state))}var plugins={importmodule:addPluginPattern("importmodule","tag",["string","builtin"]),documentclass:addPluginPattern("documentclass","tag",["","atom"]),usepackage:addPluginPattern("usepackage","tag",["atom"]),begin:addPluginPattern("begin","tag",["atom"]),end:addPluginPattern("end","tag",["atom"]),label:addPluginPattern("label","tag",["atom"]),ref:addPluginPattern("ref","tag",["atom"]),eqref:addPluginPattern("eqref","tag",["atom"]),cite:addPluginPattern("cite","tag",["atom"]),bibitem:addPluginPattern("bibitem","tag",["atom"]),Bibitem:addPluginPattern("Bibitem","tag",["atom"]),RBibitem:addPluginPattern("RBibitem","tag",["atom"]),DEFAULT:function(){this.name="DEFAULT",this.style="tag",this.styleIdentifier=this.openBracket=this.closeBracket=function(){}}};return{startState:function(){var f=mathMode?function(source,state){return inMathMode(source,state)}:normal;return{cmdState:[],f:f}},copyState:function(s){return{cmdState:s.cmdState.slice(),f:s.f}},token:function(stream,state){return state.f(stream,state)},blankLine:function(state){state.f=normal,state.cmdState.length=0},languageData:{commentTokens:{line:"%"}}}}Object.defineProperty(exports,"__esModule",{value:!0});const stex=mkStex(!1),stexMath=mkStex(!0);return exports.stex=stex,exports.stexMath=stexMath,exports}